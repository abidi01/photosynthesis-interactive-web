<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é˜¿å°”å†œå®éªŒæ¨¡æ‹Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 0;
        }
        
        .main-content {
            padding: 20px;
        }
        
        nav {
            background: linear-gradient(to right, #2D7D46, #1B5E20);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0.75rem 1.25rem;
        }
        
        .nav-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .nav-brand {
            display: flex;
            align-items: center;
        }
        
        .nav-brand span {
            font-size: 1.5rem;
            margin-right: 0.75rem;
        }
        
        .nav-brand h1 {
            font-size: 1.25rem;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            margin: 0;
        }
        
        .nav-links {
            display: flex;
            gap: 0.25rem;
            flex-wrap: wrap;
        }
        
        .nav-item {
            color: white;
            text-decoration: none;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            background: rgba(255, 255, 255, 0.2);
            transition: all 0.3s;
            display: inline-block;
        }
        
        .nav-item:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .nav-item.active {
            background: rgba(255, 255, 255, 0.4);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #2e7d32;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .experiment-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .experiment-left, .experiment-right {
            flex: 1;
            min-width: 300px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .flask-container {
            text-align: center;
            margin: 20px 0;
            position: relative;
        }
        
        .light-indicator-top {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
            color: white;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.5s ease;
            z-index: 10;
        }
        
        .light-on {
            background: linear-gradient(45deg, #ffd600, #ffab00);
            animation: pulse 2s infinite;
        }
        
        .light-off {
            background: linear-gradient(45deg, #616161, #424242);
        }
        
        @keyframes pulse {
            0% {
                box-shadow: 0 3px 10px rgba(255, 214, 0, 0.4);
            }
            50% {
                box-shadow: 0 3px 20px rgba(255, 214, 0, 0.8);
            }
            100% {
                box-shadow: 0 3px 10px rgba(255, 214, 0, 0.4);
            }
        }
        
        .light-indicator-top::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid;
        }
        
        .light-on::after {
            border-top-color: #ffab00;
        }
        
        .light-off::after {
            border-top-color: #424242;
        }
        
        .flask {
            width: 200px;
            height: 300px;
            background: linear-gradient(to bottom, #e3f2fd, #bbdefb);
            border-radius: 20px 20px 0 0;
            margin: 0 auto;
            position: relative;
            overflow: hidden;
            border: 3px solid #90caf9;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .flask-label {
            margin-top: 10px;
            font-size: 14px;
            color: #2e7d32;
            font-weight: bold;
        }
        
        .suspension {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 80%;
            background: linear-gradient(to top, #81c784, #a5d6a7);
            transition: all 0.5s ease;
        }
        
        .bubbles, .molecules {
            position: absolute;
            width: 100%;
            height: 80%;
            bottom: 0;
            pointer-events: none;
        }
        
        .bubble {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 50%;
            animation: rise linear infinite;
        }
        
        .molecule-dot {
            position: absolute;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: float linear infinite;
        }
        
        .atp-dot {
            background-color: #ff5722;
            box-shadow: 0 0 5px #ff5722;
        }
        
        .nadph-dot {
            background-color: #2196f3;
            box-shadow: 0 0 5px #2196f3;
        }
        
        @keyframes rise {
            0% {
                transform: translateY(0) scale(0.8);
                opacity: 0;
            }
            20% {
                opacity: 1;
            }
            100% {
                transform: translateY(-200px) scale(1.2);
                opacity: 0;
            }
        }
        
        @keyframes float {
            0% {
                transform: translate(0, 0) scale(0.8);
                opacity: 0;
            }
            20% {
                opacity: 1;
            }
            100% {
                transform: translate(50px, -150px) scale(1.2);
                opacity: 0;
            }
        }
        
        .controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }
        
        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: #f1f8e9;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .control-group:hover {
            background: #e8f5e9;
            transform: translateY(-2px);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        }
        
        label {
            width: 120px;
            font-weight: bold;
            color: #2e7d32;
        }
        
        .switch-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #2e7d32;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        button {
            background: linear-gradient(to bottom, #2e7d32, #1b5e20);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            flex: 1;
            transition: all 0.3s ease;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.2);
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        }
        
        button:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        button:disabled {
            background: linear-gradient(to bottom, #cccccc, #aaaaaa);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .results {
            margin-top: 20px;
            padding: 15px;
            background: linear-gradient(to bottom, #e8f5e9, #c8e6c9);
            border-radius: 8px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        
        .result-item:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: translateX(5px);
        }
        
        .light-indicator {
            width: 100%;
            height: 30px;
            background: linear-gradient(to right, #000000, #ffff00);
            margin: 10px 0;
            border-radius: 5px;
            display: none;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        .chart-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .chart-wrapper {
            height: 200px;
            position: relative;
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .chart-title {
            font-size: 16px;
            color: #333;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .chart {
            width: 100%;
            height: 100%;
            position: relative;
            background: #f9f9f9;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .chart-grid {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .grid-line {
            height: 1px;
            background-color: rgba(0,0,0,0.1);
            position: relative;
        }
        
        .grid-line::after {
            content: attr(data-value);
            position: absolute;
            right: 5px;
            top: -10px;
            font-size: 12px;
            color: #666;
        }
        
        .chart-area {
            position: absolute;
            width: 100%;
            height: 100%;
        }
        
        .chart-line {
            stroke-width: 3;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        
        .atp-line {
            stroke: #ff5722;
        }
        
        .nadph-line {
            stroke: #2196f3;
            stroke-dasharray: 5, 3;
        }
        
        .chart-legend {
            position: absolute;
            bottom: 10px;
            right: 10px;
            display: flex;
            gap: 15px;
            background: rgba(255,255,255,0.8);
            padding: 5px 10px;
            border-radius: 5px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            font-size: 14px;
        }
        
        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            margin-right: 8px;
        }
        
        .atp-legend {
            background-color: #ff5722;
        }
        
        .nadph-legend {
            background-color: #2196f3;
        }
        
        .explanation {
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            line-height: 1.6;
        }
        
        .explanation h2 {
            color: #1565c0;
            margin-bottom: 15px;
            border-bottom: 2px solid #bbdefb;
            padding-bottom: 10px;
        }
        
        .key-points {
            background: #fff3e0;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #ff9800;
        }
        
        .key-points h3 {
            margin-bottom: 10px;
            color: #ef6c00;
        }
        
        .key-points ul {
            padding-left: 20px;
            margin: 10px 0;
        }
        
        .key-points li {
            margin-bottom: 8px;
            position: relative;
            line-height: 1.6;
        }
        
        .key-points li:before {
            content: "â€¢";
            color: #ff9800;
            font-weight: bold;
            position: absolute;
            left: -15px;
        }
        
        .highlight {
            background-color: #fff9c4;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: bold;
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            padding: 15px;
            color: #666;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .experiment-container {
                flex-direction: column;
            }
            
            .button-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav>
        <div class="nav-container">
            <div class="nav-content">
                <div class="nav-brand">
                    <span>ğŸƒ</span>
                    <h1>å…‰åˆä½œç”¨åŸç†æ¢ç´¢äº¤äº’ç½‘é¡µ</h1>
                </div>
                <div class="nav-links">
                    <a href="main.html" class="nav-item">é¦–é¡µ</a>
                    <a href="å¸Œå°”å®éªŒæ¨¡æ‹Ÿå·¥å…·.html" class="nav-item">å¸Œå°”å®éªŒ</a>
                    <a href="é˜¿å°”å†œå®éªŒæ¨¡æ‹Ÿå·¥å…·.html" class="nav-item active">é˜¿å°”å†œå®éªŒ</a>
                    <a href="è´¾æ ¼é“å¤«å®éªŒæ¨¡æ‹Ÿå·¥å…·.html" class="nav-item">è´¾æ ¼é“å¤«å®éªŒ</a>
                    <a href="å…‰ååº”.html" class="nav-item">å…‰ååº”æ¨¡å‹</a>
                    <a href="é˜¿å°”å†œè™šæ‹Ÿå®éªŒå·¥å…·2.html" class="nav-item">é˜¿å°”å†œ2</a>
                    <a href="å¡å°”æ–‡å¾ªç¯å®éªŒæ¨¡æ‹Ÿå·¥å…·.html" class="nav-item">å¡å°”æ–‡å¾ªç¯</a>
                    <a href="å…‰ååº”å’Œæš—ååº”ä¹‹é—´çš„è”ç³».html" class="nav-item">å…‰æš—ååº”è”ç³»</a>
                    <a href="å¯¹æ¥é«˜è€ƒ.html" class="nav-item">å¯¹æ¥é«˜è€ƒ</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="main-content">
        <div class="container">
            <header>
            <h1>é˜¿å°”å†œå®éªŒæ¨¡æ‹Ÿ</h1>
            <!-- ç§»é™¤äº†å‰¯æ ‡é¢˜ -->
        </header>
        
        <div class="experiment-container">
            <div class="experiment-left">
                <h2>å®éªŒè£…ç½®</h2>
                <div class="flask-container">
                    <div class="light-indicator-top" id="light-indicator-top">å…‰ç…§</div>
                    
                    <div class="flask">
                        <div class="suspension" id="suspension"></div>
                        <div class="bubbles" id="bubbles"></div>
                        <div class="molecules" id="molecules"></div>
                    </div>
                    <div class="flask-label">ç¦»ä½“çš„å¶ç»¿ä½“æ‚¬æµ®æ¶²</div>
                </div>
                
                <div class="controls">
                    <div class="control-group">
                        <label>å…‰ç…§æ§åˆ¶:</label>
                        <div class="switch-group">
                            <label class="switch">
                                <input type="checkbox" id="light-switch" checked>
                                <span class="slider"></span>
                            </label>
                            <span id="light-status">å¼€å¯</span>
                        </div>
                    </div>
                    
                    <div class="light-indicator" id="light-indicator"></div>
                    
                    <div class="control-group">
                        <label>ADP + Pi:</label>
                        <div class="switch-group">
                            <label class="switch">
                                <input type="checkbox" id="adp-pi-switch" checked>
                                <span class="slider"></span>
                            </label>
                            <span id="adp-pi-status">å¼€å¯</span>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label>NADP+:</label>
                        <div class="switch-group">
                            <label class="switch">
                                <input type="checkbox" id="nadp-switch" checked>
                                <span class="slider"></span>
                            </label>
                            <span id="nadp-status">å¼€å¯</span>
                        </div>
                    </div>
                    
                    <div class="button-group">
                        <button id="start-btn">å¼€å§‹å®éªŒ</button>
                        <button id="stop-btn" disabled>åœæ­¢å®éªŒ</button>
                        <button id="reset-btn">é‡ç½®å®éªŒ</button>
                    </div>
                </div>
                
                <div class="results" id="results">
                    <h3>å®éªŒç»“æœ</h3>
                    <div class="result-item">
                        <span>ATPäº§ç”Ÿé‡:</span>
                        <span id="atp-result">0</span> Î¼mol
                    </div>
                    <div class="result-item">
                        <span>NADPHäº§ç”Ÿé‡:</span>
                        <span id="nadph-result">0</span> Î¼mol
                    </div>
                    <div class="result-item">
                        <span>æ°§æ°”é‡Šæ”¾é‡:</span>
                        <span id="oxygen-result">0</span> Î¼mol
                    </div>
                </div>
            </div>
            
            <div class="experiment-right">
                <h2>äº§ç‰©ç”Ÿæˆæ›²çº¿</h2>
                <div class="chart-container">
                    <div class="chart-wrapper atp-chart">
                        <div class="chart-title">ATPç”Ÿæˆæ›²çº¿</div>
                        <div class="chart">
                            <div class="chart-grid">
                                <div class="grid-line" data-value="100"></div>
                                <div class="grid-line" data-value="75"></div>
                                <div class="grid-line" data-value="50"></div>
                                <div class="grid-line" data-value="25"></div>
                                <div class="grid-line" data-value="0"></div>
                            </div>
                            <svg class="chart-area" id="atp-chart-svg" viewBox="0 0 100 100" preserveAspectRatio="none">
                                <path class="chart-line atp-line" id="atp-line" d=""></path>
                            </svg>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color atp-legend"></div>
                                    <span>ATP</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="chart-wrapper nadph-chart">
                        <div class="chart-title">NADPHç”Ÿæˆæ›²çº¿</div>
                        <div class="chart">
                            <div class="chart-grid">
                                <div class="grid-line" data-value="100"></div>
                                <div class="grid-line" data-value="75"></div>
                                <div class="grid-line" data-value="50"></div>
                                <div class="grid-line" data-value="25"></div>
                                <div class="grid-line" data-value="0"></div>
                            </div>
                            <svg class="chart-area" id="nadph-chart-svg" viewBox="0 0 100 100" preserveAspectRatio="none">
                                <path class="chart-line nadph-line" id="nadph-line" d=""></path>
                            </svg>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color nadph-legend"></div>
                                    <span>NADPH</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="explanation">
            <h2>é˜¿å°”å†œå®éªŒåŸç†</h2>
            
            <div class="key-points">
                <h3>æ ¸å¿ƒå‘ç°</h3>
                <ul>
                    <li>å…‰ç…§é©±åŠ¨æ°´çš„å…‰è§£ï¼Œäº§ç”Ÿæ°§æ°”</li>
                    <li>å…‰èƒ½è½¬åŒ–ä¸ºATPå’ŒNADPHä¸­çš„åŒ–å­¦èƒ½</li>
                    <li>ç”µå­ä¼ é€’é“¾å»ºç«‹è´¨å­æ¢¯åº¦é©±åŠ¨ATPåˆæˆ</li>
                    <li>NADP+æ¥å—ç”µå­å’Œè´¨å­å½¢æˆNADPH</li>
                    <li>æ•´ä¸ªè¿‡ç¨‹å®Œå…¨ä¾èµ–å…‰ç…§</li>
                </ul>
            </div>
        </div>
        
            <footer>
                <p>é˜¿å°”å†œå®éªŒæ¨¡æ‹Ÿå·¥å…· - é«˜ä¸­ç”Ÿç‰©æ•™å­¦è¾…åŠ©èµ„æº</p>
            </footer>
        </div>
    </div>

    <script>
        // è·å–DOMå…ƒç´ 
        const lightSwitch = document.getElementById('light-switch');
        const lightStatus = document.getElementById('light-status');
        const lightIndicator = document.getElementById('light-indicator');
        const adpPiSwitch = document.getElementById('adp-pi-switch');
        const adpPiStatus = document.getElementById('adp-pi-status');
        const nadpSwitch = document.getElementById('nadp-switch');
        const nadpStatus = document.getElementById('nadp-status');
        const startBtn = document.getElementById('start-btn');
        const stopBtn = document.getElementById('stop-btn');
        const resetBtn = document.getElementById('reset-btn');
        const atpResult = document.getElementById('atp-result');
        const nadphResult = document.getElementById('nadph-result');
        const oxygenResult = document.getElementById('oxygen-result');
        const suspension = document.getElementById('suspension');
        const bubblesContainer = document.getElementById('bubbles');
        const moleculesContainer = document.getElementById('molecules');
        const atpLine = document.getElementById('atp-line');
        const nadphLine = document.getElementById('nadph-line');
        const lightIndicatorTop = document.getElementById('light-indicator-top');
        
        let experimentInterval = null;
        let dataPoints = [];
        let timeCounter = 0;
        
        // å…‰ç…§å¼€å…³
        lightSwitch.addEventListener('change', () => {
            lightStatus.textContent = lightSwitch.checked ? 'å¼€å¯' : 'å…³é—­';
            lightIndicator.style.display = lightSwitch.checked ? 'block' : 'none';
            
            // æ›´æ–°è¯•ç®¡ä¸Šæ–¹çš„å…‰ç…§çŠ¶æ€æ˜¾ç¤º
            if (lightSwitch.checked) {
                lightIndicatorTop.textContent = 'å…‰ç…§';
                lightIndicatorTop.className = 'light-indicator-top light-on';
            } else {
                lightIndicatorTop.textContent = 'é»‘æš—';
                lightIndicatorTop.className = 'light-indicator-top light-off';
            }
        });
        
        // ADP + Piå¼€å…³
        adpPiSwitch.addEventListener('change', () => {
            adpPiStatus.textContent = adpPiSwitch.checked ? 'å¼€å¯' : 'å…³é—­';
        });
        
        // NADP+å¼€å…³
        nadpSwitch.addEventListener('change', () => {
            nadpStatus.textContent = nadpSwitch.checked ? 'å¼€å¯' : 'å…³é—­';
        });
        
        // å¼€å§‹å®éªŒ
        startBtn.addEventListener('click', () => {
            startBtn.disabled = true;
            stopBtn.disabled = false;
            timeCounter = 0;
            dataPoints = [];
            updateChart();
            
            if (experimentInterval) {
                clearInterval(experimentInterval);
            }
            
            runExperiment();
            experimentInterval = setInterval(runExperiment, 2000);
        });
        
        // åœæ­¢å®éªŒ
        stopBtn.addEventListener('click', () => {
            stopBtn.disabled = true;
            startBtn.disabled = false;
            
            if (experimentInterval) {
                clearInterval(experimentInterval);
                experimentInterval = null;
            }
        });
        
        // é‡ç½®å®éªŒ
        resetBtn.addEventListener('click', () => {
            if (experimentInterval) {
                clearInterval(experimentInterval);
                experimentInterval = null;
            }
            
            atpResult.textContent = '0';
            nadphResult.textContent = '0';
            oxygenResult.textContent = '0';
            
            bubblesContainer.innerHTML = '';
            moleculesContainer.innerHTML = '';
            suspension.style.backgroundColor = '#81c784';
            
            dataPoints = [];
            timeCounter = 0;
            updateChart();
            
            // é‡ç½®å…‰ç…§çŠ¶æ€æ˜¾ç¤º
            lightIndicatorTop.textContent = 'å…‰ç…§';
            lightIndicatorTop.className = 'light-indicator-top light-on';
            
            startBtn.disabled = false;
            stopBtn.disabled = true;
        });
        
        // æ‰§è¡Œå®éªŒ
        function runExperiment() {
            const lightOn = lightSwitch.checked;
            const adpPiOn = adpPiSwitch.checked;
            const nadpOn = nadpSwitch.checked;
            
            // æ›´æ–°å…‰ç…§çŠ¶æ€æ˜¾ç¤º
            if (lightOn) {
                lightIndicatorTop.textContent = 'å…‰ç…§';
                lightIndicatorTop.className = 'light-indicator-top light-on';
            } else {
                lightIndicatorTop.textContent = 'é»‘æš—';
                lightIndicatorTop.className = 'light-indicator-top light-off';
            }
            
            const light = lightOn ? 1 : 0;
            const adpPi = adpPiOn ? 1 : 0;
            const nadp = nadpOn ? 1 : 0;
            
            // æ¨¡æ‹Ÿäº§ç‰©ç”Ÿæˆ (è¿›ä¸€æ­¥é™ä½ç”Ÿæˆé€Ÿåº¦)
            const timeFactor = Math.min(1, timeCounter / 15);
            const smoothFactor = 1 - Math.exp(-timeCounter / 10);
            
            const atp = Math.round(100 * light * adpPi * smoothFactor);
            const nadph = Math.round(100 * light * nadp * smoothFactor);
            const oxygen = Math.round(50 * light * smoothFactor);
            
            atpResult.textContent = atp;
            nadphResult.textContent = nadph;
            oxygenResult.textContent = oxygen;
            
            timeCounter++;
            dataPoints.push({
                time: timeCounter,
                atp: atp,
                nadph: nadph
            });
            
            if (dataPoints.length > 30) {
                dataPoints.shift();
            }
            
            updateChart();
            animateBubbles(oxygen);
            animateMolecules(atp, nadph);
            
            const greenIntensity = lightOn ? 200 : 100;
            suspension.style.backgroundColor = `rgb(100, ${greenIntensity}, 100)`;
        }
        
        // æ›´æ–°å›¾è¡¨
        function updateChart() {
            const maxValue = Math.max(100, ...dataPoints.map(d => Math.max(d.atp, d.nadph)));
            
            let atpPath = '';
            if (dataPoints.length > 0) {
                dataPoints.forEach((point, index) => {
                    const x = (index / (dataPoints.length - 1)) * 100;
                    const y = 100 - (point.atp / maxValue) * 100;
                    if (index === 0) {
                        atpPath = `M ${x} ${y}`;
                    } else {
                        atpPath += ` L ${x} ${y}`;
                    }
                });
            }
            atpLine.setAttribute('d', atpPath);
            
            let nadphPath = '';
            if (dataPoints.length > 0) {
                dataPoints.forEach((point, index) => {
                    const x = (index / (dataPoints.length - 1)) * 100;
                    const y = 100 - (point.nadph / maxValue) * 100;
                    if (index === 0) {
                        nadphPath = `M ${x} ${y}`;
                    } else {
                        nadphPath += ` L ${x} ${y}`;
                    }
                });
            }
            nadphLine.setAttribute('d', nadphPath);
        }
        
        // æ°”æ³¡åŠ¨ç”»
        function animateBubbles(oxygenAmount) {
            bubblesContainer.innerHTML = '';
            
            const bubbleCount = Math.min(20, Math.floor(oxygenAmount / 5));
            
            for (let i = 0; i < bubbleCount; i++) {
                const bubble = document.createElement('div');
                bubble.className = 'bubble';
                
                const size = 5 + Math.random() * 10;
                const left = 10 + Math.random() * 180;
                const delay = Math.random() * 2;
                const duration = 3 + Math.random() * 2;
                
                bubble.style.width = `${size}px`;
                bubble.style.height = `${size}px`;
                bubble.style.left = `${left}px`;
                bubble.style.bottom = '0';
                bubble.style.animationDuration = `${duration}s`;
                bubble.style.animationDelay = `${delay}s`;
                
                bubblesContainer.appendChild(bubble);
            }
        }
        
        // åˆ†å­åŠ¨ç”»
        function animateMolecules(atpAmount, nadphAmount) {
            moleculesContainer.innerHTML = '';
            
            const atpCount = Math.min(30, Math.floor(atpAmount / 5));
            for (let i = 0; i < atpCount; i++) {
                const atp = document.createElement('div');
                atp.className = 'molecule-dot atp-dot';
                
                const left = 30 + Math.random() * 140;
                const delay = Math.random() * 2;
                const duration = 4 + Math.random() * 2;
                
                atp.style.left = `${left}px`;
                atp.style.bottom = '20px';
                atp.style.animationDuration = `${duration}s`;
                atp.style.animationDelay = `${delay}s`;
                
                moleculesContainer.appendChild(atp);
            }
            
            const nadphCount = Math.min(30, Math.floor(nadphAmount / 5));
            for (let i = 0; i < nadphCount; i++) {
                const nadph = document.createElement('div');
                nadph.className = 'molecule-dot nadph-dot';
                
                const left = 30 + Math.random() * 140;
                const delay = Math.random() * 2;
                const duration = 4 + Math.random() * 2;
                
                nadph.style.left = `${left}px`;
                nadph.style.bottom = '20px';
                nadph.style.animationDuration = `${duration}s`;
                nadph.style.animationDelay = `${delay}s`;
                
                moleculesContainer.appendChild(nadph);
            }
        }
    </script>
</body>
</html>